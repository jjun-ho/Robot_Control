function dydt = three_link(t,y)

global Iz1 Iz2 Iz3 L1 L2 L3 g m1 m2 m3 r1 r2 r3 tq1 tq2 tq3

th1  = y(1);
dth1 = y(2);
th2  = y(3);
dth2 = y(4);
th3  = y(5);
dth3 = y(6);

t2 = cos(th1);
t3 = cos(th2);
t4 = cos(th3);
t5 = sin(th2);
t6 = sin(th3);
t7 = th1+th2;
t8 = th2+th3;
t9 = L1.^2;
t10 = L2.^2;
t11 = L3.^2;
t12 = dth1.^2;
t13 = dth2.^2;
t14 = dth3.^2;
t15 = m2.^2;
t16 = m3.^2;
t17 = m3.^3;
t18 = r2.^2;
t19 = r3.^2;
t20 = Iz1.*Iz3;
t21 = Iz2.*Iz3;
t31 = -tq2;
t32 = -tq3;
t52 = Iz3.*L1.*m1.*r1.*2.0;
t53 = Iz3.*L2.*m2.*r2.*2.0;
t54 = Iz1.*L3.*m3.*r3.*2.0;
t55 = Iz2.*L3.*m3.*r3.*2.0;
t75 = L1.*L3.*m1.*m3.*r1.*r3.*4.0;
t76 = L2.*L3.*m2.*m3.*r2.*r3.*4.0;
t104 = Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0;
t178 = L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
t22 = t3.^2;
t23 = t4.^2;
t24 = Iz2.*t20;
t25 = L2.*t5;
t26 = L2.*t6;
t27 = cos(t7);
t28 = cos(t8);
t29 = sin(t8);
t30 = t7+th3;
t34 = m1.*r1.*t2;
t36 = m2.*r2.*t5;
t37 = L1.*m2.*t2;
t38 = L1.*m3.*t2;
t40 = Iz3.*L2.*m3.*t3;
t41 = Iz3.*m2.*r2.*t3;
t45 = Iz3.*m1.*t9;
t46 = Iz3.*m2.*t9;
t47 = Iz1.*m3.*t11;
t48 = Iz3.*m3.*t9;
t49 = Iz3.*m2.*t10;
t50 = Iz2.*m3.*t11;
t51 = Iz3.*m3.*t10;
t56 = m1.*t9.*t21;
t57 = m2.*t10.*t20;
t58 = m2.*t9.*t21;
t60 = m3.*t10.*t20;
t61 = m3.*t9.*t21;
t62 = L1.*m1.*r1.*t21.*2.0;
t63 = L2.*m2.*r2.*t20.*2.0;
t64 = Iz2.*t54;
t67 = Iz1.*L2.*m3.*r3.*t4;
t85 = m2.*m3.*r2.*t3.*t11;
t93 = L3.*m2.*m3.*r2.*r3.*t3.*2.0;
t95 = m1.*m3.*t9.*t11;
t96 = m2.*m3.*t9.*t11;
t97 = m2.*m3.*t10.*t11;
t98 = L1.*m1.*m3.*r1.*t11.*2.0;
t99 = L3.*m1.*m3.*r3.*t9.*2.0;
t100 = L2.*m2.*m3.*r2.*t11.*2.0;
t101 = L3.*m2.*m3.*r3.*t9.*2.0;
t102 = L3.*m2.*m3.*r3.*t10.*2.0;
t105 = Iz2.*t75;
t106 = Iz1.*t76;
t107 = L2.*L3.*r3.*t3.*t16.*2.0;
t108 = L2.*m2.*m3.*r2.*r3.*t3.*t4;
t113 = L2.*m1.*m3.*r3.*t4.*t9;
t114 = L2.*m2.*m3.*r3.*t4.*t9;
t115 = t9.*t11.*t16;
t116 = t10.*t11.*t16;
t117 = L1.*L2.*m1.*m3.*r1.*r3.*t4.*2.0;
t119 = L3.*r3.*t9.*t16.*2.0;
t120 = L3.*r3.*t10.*t16.*2.0;
t135 = m1.*t9.*t55;
t137 = m2.*t10.*t54;
t138 = m2.*t9.*t55;
t139 = L2.*t3.*t11.*t16;
t149 = L2.*r3.*t4.*t9.*t16;
t153 = Iz3.*t9.*t10.*t15;
t156 = Iz3.*t9.*t10.*t16;
t157 = Iz3.*L2.*r2.*t9.*t15.*2.0;
t164 = Iz2.*L3.*m1.*m3.*r3.*t9.*-2.0;
t165 = Iz1.*L3.*m2.*m3.*r3.*t10.*-2.0;
t173 = L1.*L2.*m1.*m2.*m3.*r1.*r2.*t11.*4.0;
t174 = m2.*t10.*t75;
t175 = m1.*t9.*t76;
t180 = r3.*t3.*t4.*t10.*t16;
t182 = t9.*t10.*t11.*t17;
t183 = L3.*r3.*t9.*t10.*t17.*2.0;
t192 = L1.*L3.*m1.*r1.*r3.*t10.*t16.*4.0;
t193 = L2.*L3.*m2.*r2.*r3.*t9.*t16.*4.0;
t194 = L2.*L3.*m3.*r2.*r3.*t9.*t15.*4.0;
t199 = L1.*L3.*m1.*m2.*m3.*r1.*r3.*t10.*-4.0;
t200 = L2.*L3.*m1.*m2.*m3.*r2.*r3.*t9.*-4.0;
t205 = m3.*t9.*t10.*t11.*t15;
t208 = L2.*m3.*r2.*t9.*t11.*t15.*2.0;
t210 = L3.*m3.*r3.*t9.*t10.*t15.*2.0;
t226 = L3.*m1.*r3.*t9.*t10.*t16.*-2.0;
t33 = m3.*t25;
t35 = cos(t30);
t39 = t28.^2;
t42 = L1.*t29;
t43 = L1.*t36;
t44 = r3.*t29;
t59 = Iz2.*t47;
t65 = L1.*t40;
t66 = L1.*t41;
t68 = L2.*m3.*t27;
t69 = m2.*r2.*t27;
t72 = Iz2.*m3.*r3.*t28;
t77 = -t45;
t78 = -t47;
t79 = -t49;
t80 = -t50;
t81 = -t56;
t82 = -t57;
t87 = m3.*r3.*t12.*t26;
t88 = m3.*r3.*t13.*t26;
t89 = m3.*r3.*t14.*t26;
t90 = dth1.*dth2.*m3.*r3.*t26.*2.0;
t91 = dth1.*dth3.*m3.*r3.*t26.*2.0;
t92 = dth2.*dth3.*m3.*r3.*t26.*2.0;
t112 = L1.*t85;
t118 = L1.*t93;
t121 = -t98;
t122 = -t99;
t123 = -t100;
t124 = -t102;
t125 = m2.*t10.*t45;
t126 = m1.*t9.*t50;
t127 = m3.*t10.*t45;
t128 = m2.*t10.*t47;
t129 = m2.*t9.*t50;
t130 = L1.*m1.*r1.*t49.*2.0;
t131 = L1.*m1.*r1.*t50.*2.0;
t132 = L1.*m1.*r1.*t51.*2.0;
t133 = L2.*m2.*r2.*t45.*2.0;
t134 = L2.*m2.*r2.*t47.*2.0;
t136 = L2.*m3.*r2.*t46.*2.0;
t140 = m2.*m3.*r3.*t10.*t28;
t142 = L2.*m2.*m3.*r2.*r3.*t28.*2.0;
t143 = -t85;
t145 = L1.*t139;
t146 = L1.*t107;
t148 = L1.*t108;
t152 = -t96;
t154 = Iz1.*t116;
t155 = Iz2.*t115;
t158 = Iz1.*t120;
t159 = Iz2.*t119;
t170 = -t113;
t171 = -t115;
t172 = -t116;
t179 = r3.*t10.*t16.*t28;
t181 = -t139;
t185 = L1.*t180;
t187 = L1.*L2.*m2.*m3.*r2.*r3.*t28.*-2.0;
t188 = m2.*t10.*t95;
t189 = L1.*m1.*r1.*t97.*2.0;
t190 = L2.*m2.*r2.*t95.*2.0;
t191 = m2.*t10.*t99;
t195 = -t153;
t198 = -t173;
t202 = m2.*m3.*r2.*r3.*t3.*t9.*t28;
t204 = m1.*t10.*t115;
t206 = L1.*m1.*r1.*t116.*2.0;
t207 = L2.*m2.*r2.*t115.*2.0;
t209 = m1.*t10.*t119;
t211 = L2.*t4.*t16.*t19.*t28;
t212 = t10.*t16.*t19.*t23;
t214 = t22.*t156;
t215 = L2.*r3.*t3.*t9.*t16.*t28;
t217 = L2.*m3.*r2.*t22.*t46.*-2.0;
t218 = Iz3.*t9.*t15.*t18.*t22;
t220 = -t182;
t225 = -t208;
t227 = -t210;
t240 = t22.*t182;
t241 = t22.*t183;
t242 = t9.*t10.*t17.*t19.*t23;
t243 = t22.*t193;
t246 = L3.*m3.*r3.*t9.*t15.*t18.*t22.*2.0;
t247 = L3.*r3.*t9.*t10.*t17.*t22.*-2.0;
t251 = L2.*L3.*m2.*r2.*r3.*t9.*t16.*t22.*-4.0;
t253 = m3.*t9.*t11.*t15.*t18.*t22;
t267 = t3.*t4.*t9.*t10.*t17.*t19.*t28.*2.0;
t70 = m3.*t44;
t71 = g.*t68;
t73 = g.*t69;
t74 = m3.*r3.*t35;
t83 = -t59;
t84 = L1.*t12.*t33;
t86 = t12.*t43;
t94 = L1.*t72;
t109 = -t72;
t110 = -t91;
t111 = -t92;
t141 = m3.*r3.*t12.*t42;
t144 = -t89;
t147 = t26+t42;
t151 = t25+t44;
t160 = -t130;
t161 = -t131;
t162 = -t133;
t163 = -t134;
t166 = -t142;
t167 = L1.*t140;
t168 = L1.*t142;
t169 = -t112;
t176 = m3.*t10.*t77;
t177 = m2.*t9.*t80;
t184 = L1.*t179;
t186 = -t145;
t196 = -t154;
t197 = -t155;
t201 = t22.*t136;
t213 = -t179;
t216 = L1.*t211;
t219 = Iz1.*t212;
t222 = -t188;
t223 = -t206;
t224 = -t207;
t228 = -t202;
t229 = t9.*t16.*t19.*t39;
t230 = -t211;
t231 = -t212;
t232 = -t214;
t233 = -t215;
t235 = -t218;
t245 = L1.*m1.*r1.*t212.*2.0;
t250 = t22.*t207;
t252 = m1.*t9.*t212;
t254 = m2.*t9.*t212;
t256 = -t246;
t257 = t9.*t10.*t17.*t19.*t39;
t258 = -t242;
t266 = m2.*r2.*t3.*t9.*t211.*2.0;
t103 = g.*t74;
t150 = -t94;
t203 = L1.*m3.*t151;
t221 = -t184;
t234 = -t216;
t236 = -t219;
t237 = m3.*r3.*t14.*t147;
t238 = dth1.*dth3.*m3.*r3.*t147.*2.0;
t239 = dth2.*dth3.*m3.*r3.*t147.*2.0;
t244 = Iz2.*t229;
t248 = t33+t36+t70;
t249 = -t229;
t255 = -t245;
t260 = m2.*t10.*t229;
t261 = L2.*m2.*r2.*t229.*2.0;
t262 = m2.*t9.*t231;
t263 = -t257;
t270 = t34+t37+t38+t68+t69+t74;
t275 = t40+t41+t93+t107+t108+t109+t140+t143+t166+t180+t181+t213+t230;
t259 = -t244;
t264 = t43+t203;
t265 = -t261;
t268 = L1.*t13.*t248;
t269 = L1.*dth1.*dth2.*t248.*2.0;
t271 = g.*t270;
t273 = t32+t87+t88+t90+t103+t141;
t274 = t31+t71+t73+t84+t86+t103+t110+t111+t141+t144;
t277 = t21+t51+t53+t55+t65+t66+t76+t79+t80+t97+t118+t120+t123+t124+t146+t169+t172+t186+t231+t234;
t278 = t20+t46+t48+t52+t54+t65+t66+t67+t75+t77+t78+t95+t101+t114+t117+t118+t119+t121+t122+t146+t148+t149+t150+t152+t167+t169+t170+t171+t185+t186+t187+t221+t228+t233+t234+t249;
t272 = -t271;
t279 = t24+t58+t60+t61+t62+t63+t64+t81+t82+t83+t104+t105+t106+t125+t126+t128+t132+t136+t138+t156+t157+t158+t159+t160+t161+t162+t163+t164+t165+t176+t177+t178+t183+t189+t190+t191+t192+t193+t194+t195+t196+t197+t198+t199+t200+t204+t205+t217+t220+t222+t223+t224+t225+t226+t227+t232+t235+t236+t240+t247+t250+t251+t252+t253+t255+t256+t258+t259+t260+t262+t263+t265+t266+t267;
t276 = t237+t238+t239+t268+t269+t272+tq1;
t280 = 1.0./t279;
mt1 = [dth1;t276.*t280.*(t21+t51+t53+t55+t76+t79+t80+t97+t120+t123+t124+t172+t231)+t274.*t277.*t280-L1.*t273.*t275.*t280;dth2;-t280.*(t71+t73+t103+t110+t111+t144-tq2+t12.*t264).*(t20+t21+t46+t48+t51+t52+t53+t54+t55+t65.*2.0+t66.*2.0+t75+t76+t77+t78+t79+t80+t95+t97+t101-t112.*2.0+t119+t120+t121+t122+t123+t124-t145.*2.0+t152+t171+t172-t216.*2.0+t231+t249+L1.*L2.*L3.*r3.*t3.*t16.*4.0+L1.*L3.*m2.*m3.*r2.*r3.*t3.*4.0)+t278.*t280.*(t32+t88+t90+t103+m3.*r3.*t12.*t147)-t277.*t280.*(t237+t238+t239+t272+tq1+t13.*t264+dth1.*dth2.*t264.*2.0);dth3];
mt2 = [-t273.*t280.*(t20+t46+t48+t52+t54+t67.*2.0+t75+t77+t78+t95+t101-t113.*2.0+t114.*2.0+t119+t121+t122+t149.*2.0+t152+t171-t202.*2.0-t215.*2.0+t249+Iz1.*Iz2-Iz2.*m1.*t9-Iz1.*m2.*t10+Iz2.*m2.*t9+Iz1.*m3.*t10+Iz2.*m3.*t9-t9.*t10.*t15+t9.*t10.*t16+L2.*r2.*t9.*t15.*2.0+m1.*m2.*t9.*t10-m1.*m3.*t9.*t10-t9.*t10.*t16.*t22-t9.*t15.*t18.*t22+Iz2.*L1.*m1.*r1.*2.0+Iz1.*L2.*m2.*r2.*2.0-L1.*m1.*m2.*r1.*t10.*2.0+L1.*m1.*m3.*r1.*t10.*2.0-L2.*m1.*m2.*r2.*t9.*2.0+L2.*m2.*m3.*r2.*t9.*2.0+L1.*L2.*m1.*m2.*r1.*r2.*4.0-L2.*m2.*m3.*r2.*t9.*t22.*2.0+L1.*L2.*m1.*m3.*r1.*r3.*t4.*4.0)+t274.*t278.*t280+L1.*t275.*t276.*t280];
dydt = [mt1;mt2];
